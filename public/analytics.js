(()=>{var x={bodySerializer:t=>JSON.stringify(t,(r,e)=>typeof e=="bigint"?e.toString():e)};var N={$body_:"body",$headers_:"headers",$path_:"path",$query_:"query"},oe=Object.entries(N);var q=async(t,r)=>{let e=typeof r=="function"?await r(t):r;if(e)return t.scheme==="bearer"?`Bearer ${e}`:t.scheme==="basic"?`Basic ${btoa(e)}`:e};var W=t=>{switch(t){case"label":return".";case"matrix":return";";case"simple":return",";default:return"&"}},Q=t=>{switch(t){case"form":return",";case"pipeDelimited":return"|";case"spaceDelimited":return"%20";default:return","}},V=t=>{switch(t){case"label":return".";case"matrix":return";";case"simple":return",";default:return"&"}},S=({allowReserved:t,explode:r,name:e,style:o,value:a})=>{if(!r){let s=(t?a:a.map(l=>encodeURIComponent(l))).join(Q(o));switch(o){case"label":return`.${s}`;case"matrix":return`;${e}=${s}`;case"simple":return s;default:return`${e}=${s}`}}let i=W(o),n=a.map(s=>o==="label"||o==="simple"?t?s:encodeURIComponent(s):w({allowReserved:t,name:e,value:s})).join(i);return o==="label"||o==="matrix"?i+n:n},w=({allowReserved:t,name:r,value:e})=>{if(e==null)return"";if(typeof e=="object")throw new Error("Deeply-nested arrays/objects aren\u2019t supported. Provide your own `querySerializer()` to handle these.");return`${r}=${t?e:encodeURIComponent(e)}`},C=({allowReserved:t,explode:r,name:e,style:o,value:a,valueOnly:i})=>{if(a instanceof Date)return i?a.toISOString():`${e}=${a.toISOString()}`;if(o!=="deepObject"&&!r){let l=[];Object.entries(a).forEach(([u,m])=>{l=[...l,u,t?m:encodeURIComponent(m)]});let d=l.join(",");switch(o){case"form":return`${e}=${d}`;case"label":return`.${d}`;case"matrix":return`;${e}=${d}`;default:return d}}let n=V(o),s=Object.entries(a).map(([l,d])=>w({allowReserved:t,name:o==="deepObject"?`${e}[${l}]`:l,value:d})).join(n);return o==="label"||o==="matrix"?n+s:s};var G=/\{[^{}]+\}/g,J=({path:t,url:r})=>{let e=r,o=r.match(G);if(o)for(let a of o){let i=!1,n=a.substring(1,a.length-1),s="simple";n.endsWith("*")&&(i=!0,n=n.substring(0,n.length-1)),n.startsWith(".")?(n=n.substring(1),s="label"):n.startsWith(";")&&(n=n.substring(1),s="matrix");let l=t[n];if(l==null)continue;if(Array.isArray(l)){e=e.replace(a,S({explode:i,name:n,style:s,value:l}));continue}if(typeof l=="object"){e=e.replace(a,C({explode:i,name:n,style:s,value:l,valueOnly:!0}));continue}if(s==="matrix"){e=e.replace(a,`;${w({name:n,value:l})}`);continue}let d=encodeURIComponent(s==="label"?`.${l}`:l);e=e.replace(a,d)}return e},z=({allowReserved:t,array:r,object:e}={})=>a=>{let i=[];if(a&&typeof a=="object")for(let n in a){let s=a[n];if(s!=null)if(Array.isArray(s)){let l=S({allowReserved:t,explode:!0,name:n,style:"form",value:s,...r});l&&i.push(l)}else if(typeof s=="object"){let l=C({allowReserved:t,explode:!0,name:n,style:"deepObject",value:s,...e});l&&i.push(l)}else{let l=w({allowReserved:t,name:n,value:s});l&&i.push(l)}}return i.join("&")},L=t=>{if(!t)return"stream";let r=t.split(";")[0]?.trim();if(r){if(r.startsWith("application/json")||r.endsWith("+json"))return"json";if(r==="multipart/form-data")return"formData";if(["application/","audio/","image/","video/"].some(e=>r.startsWith(e)))return"blob";if(r.startsWith("text/"))return"text"}},M=async({security:t,...r})=>{for(let e of t){let o=await q(e,r.auth);if(!o)continue;let a=e.name??"Authorization";switch(e.in){case"query":r.query||(r.query={}),r.query[a]=o;break;case"cookie":r.headers.append("Cookie",`${a}=${o}`);break;default:r.headers.set(a,o);break}return}},k=t=>K({baseUrl:t.baseUrl,path:t.path,query:t.query,querySerializer:typeof t.querySerializer=="function"?t.querySerializer:z(t.querySerializer),url:t.url}),K=({baseUrl:t,path:r,query:e,querySerializer:o,url:a})=>{let i=a.startsWith("/")?a:`/${a}`,n=(t??"")+i;r&&(n=J({path:r,url:n}));let s=e?o(e):"";return s.startsWith("?")&&(s=s.substring(1)),s&&(n+=`?${s}`),n},P=(t,r)=>{let e={...t,...r};return e.baseUrl?.endsWith("/")&&(e.baseUrl=e.baseUrl.substring(0,e.baseUrl.length-1)),e.headers=E(t.headers,r.headers),e},E=(...t)=>{let r=new Headers;for(let e of t){if(!e||typeof e!="object")continue;let o=e instanceof Headers?e.entries():Object.entries(e);for(let[a,i]of o)if(i===null)r.delete(a);else if(Array.isArray(i))for(let n of i)r.append(a,n);else i!==void 0&&r.set(a,typeof i=="object"?JSON.stringify(i):i)}return r},O=class{_fns;constructor(){this._fns=[]}clear(){this._fns=[]}getInterceptorIndex(r){return typeof r=="number"?this._fns[r]?r:-1:this._fns.indexOf(r)}exists(r){let e=this.getInterceptorIndex(r);return!!this._fns[e]}eject(r){let e=this.getInterceptorIndex(r);this._fns[e]&&(this._fns[e]=null)}update(r,e){let o=this.getInterceptorIndex(r);return this._fns[o]?(this._fns[o]=e,r):!1}use(r){return this._fns=[...this._fns,r],this._fns.length-1}},_=()=>({error:new O,request:new O,response:new O}),Y=z({allowReserved:!1,array:{explode:!0,style:"form"},object:{explode:!0,style:"deepObject"}}),X={"Content-Type":"application/json"},U=(t={})=>({...x,headers:X,parseAs:"auto",querySerializer:Y,...t});var D=(t={})=>{let r=P(U(),t),e=()=>({...r}),o=n=>(r=P(r,n),e()),a=_(),i=async n=>{let s={...r,...n,fetch:n.fetch??r.fetch??globalThis.fetch,headers:E(r.headers,n.headers)};s.security&&await M({...s,security:s.security}),s.body&&s.bodySerializer&&(s.body=s.bodySerializer(s.body)),(s.body===void 0||s.body==="")&&s.headers.delete("Content-Type");let l=k(s),d={redirect:"follow",...s},u=new Request(l,d);for(let p of a.request._fns)p&&(u=await p(u,s));let m=s.fetch,c=await m(u);for(let p of a.response._fns)p&&(c=await p(c,u,s));let g={request:u,response:c};if(c.ok){if(c.status===204||c.headers.get("Content-Length")==="0")return s.responseStyle==="data"?{}:{data:{},...g};let p=(s.parseAs==="auto"?L(c.headers.get("Content-Type")):s.parseAs)??"json";if(p==="stream")return s.responseStyle==="data"?c.body:{data:c.body,...g};let h=await c[p]();return p==="json"&&(s.responseValidator&&await s.responseValidator(h),s.responseTransformer&&(h=await s.responseTransformer(h))),s.responseStyle==="data"?h:{data:h,...g}}let y=await c.text();try{y=JSON.parse(y)}catch{}let f=y;for(let p of a.error._fns)p&&(f=await p(y,c,u,s));if(f=f||{},s.throwOnError)throw f;return s.responseStyle==="data"?void 0:{error:f,...g}};return{buildUrl:k,connect:n=>i({...n,method:"CONNECT"}),delete:n=>i({...n,method:"DELETE"}),get:n=>i({...n,method:"GET"}),getConfig:e,head:n=>i({...n,method:"HEAD"}),interceptors:a,options:n=>i({...n,method:"OPTIONS"}),patch:n=>i({...n,method:"PATCH"}),post:n=>i({...n,method:"POST"}),put:n=>i({...n,method:"PUT"}),request:i,setConfig:o,trace:n=>i({...n,method:"TRACE"})}};var v=D(U());var $=t=>(t.client??v).post({url:"/api/v2/ai/",...t,headers:{"Content-Type":"application/json",...t.headers}}),B=t=>(t.client??v).post({url:"/api/v2/analytics/events",...t,headers:{"Content-Type":"application/json",...t.headers}});var ee=document.getElementById("chatTrigger"),H=document.getElementById("chatContainer"),re=document.getElementById("closeChat"),A=document.getElementById("chatMessages"),R=document.getElementById("chatInput"),te=document.getElementById("sendBtn"),b=document.getElementById("typingIndicator"),T=!1,F=(()=>{let t=null,r=null,e=null,o=new Set;function a({siteId:c}){if(!c){console.error("Analytics: siteId is required");return}t=c,r=i(),e=Date.now(),o.clear(),u(),m(),l()}function i(){let c=sessionStorage.getItem("session_id");return c||(c=crypto.randomUUID(),sessionStorage.setItem("session_id",c)),c}function n(){return e?Math.round((Date.now()-e)/1e3):0}function s(c,g={}){if(!t)return;let y={event_name:c,event_source:"web",session_id:r,page:window.location.pathname,site_id:t,timestamp:new Date().toISOString(),time_on_page_seconds:n(),...g};console.log("[Analytics]",y),B(y).catch(f=>{console.error("Analytics event failed",f)})}function l(){s("page_view")}function d(c){s("click",{element_label:c,element_type:"interaction"})}function u(){let c=[15,30,45,60,75,90,100];function g(){let y=window.scrollY,f=document.documentElement.scrollHeight-window.innerHeight;if(f<=0)return;let p=Math.round(y/f*100);c.forEach(h=>{p>=h&&!o.has(h)&&(o.add(h),s("scroll_depth",{scroll_percent:h}))})}window.addEventListener("scroll",g,{passive:!0})}function m(){function c(){s("page_exit")}window.addEventListener("beforeunload",c),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&c()})}return{init:a,click:d}})();F.init({
  siteId: (function(){
    // fallback to the last <script> tag as the current one
    var scripts = document.getElementsByTagName('script');
    var currentScript = scripts[scripts.length - 1];
    return (currentScript && currentScript.dataset.siteId) || "BDNwebsite";
  })()
});
document.addEventListener("click",t=>{let r=t.target.closest("[data-analytics], a, button");if(!r)return;let e=r.dataset.analytics||r.id||r.getAttribute("href")||r.innerText.trim();F.click(e)});ee.addEventListener("click",()=>{H.classList.add("active"),R.focus()});re.addEventListener("click",()=>{H.classList.remove("active")});function I(t,r=!1){let e=document.createElement("div");e.className=`message ${r?"user-message":"bot-message"}`,e.innerHTML=`
        <div class="message-avatar">
            <i class="fas fa-${r?"user":"robot"}"></i>
        </div>
        <div class="message-content">${t}</div>
    `,A.insertBefore(e,b),A.scrollTop=A.scrollHeight}async function se(t){if(!t||!t.trim())return null;let r=performance.now();console.log(`[Chat] Sending message to backend: "${t}"`);try{let e=await $({body:{prompt:t}}),o=Math.round(performance.now()-r);return console.log(`[Chat] Received response from backend in ${o}ms:`,e),e&&e.message?e.message:e}catch(e){let o=Math.round(performance.now()-r);return console.error(`[Chat] Error sending message after ${o}ms:`,e),"Sorry, something went wrong while processing your request."}}async function j(){let t=R.value.trim();if(!(!t||T)){I(t,!0),R.value="",b.classList.add("active"),T=!0;try{let r=await se(t);b.classList.remove("active"),I(r)}catch{b.classList.remove("active"),I("Sorry, something went wrong. Please try again.")}finally{T=!1}}}te.addEventListener("click",j);R.addEventListener("keypress",t=>{t.key==="Enter"&&!T&&j()});document.addEventListener("click",t=>{if(t.target.classList.contains("quick-reply-btn")){let r=t.target.getAttribute("data-reply");R.value=r,j()}});})();
